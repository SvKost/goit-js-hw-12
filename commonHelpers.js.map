{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst API_KEY = '41875605-6b47be3c8e074a549a6d5f149';\nconst BASE_URL = 'https://pixabay.com/api';\n\nlet query = '';\nlet page = 1;\nlet maxPage = 0;\n\nasync function fetchImages(query, page = 1) {\n  const response = await axios.get(`${BASE_URL}/`, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 40,\n      page,\n    },\n  });\n\n  const { hits, totalHits } = response.data;\n  maxPage = Math.ceil(totalHits / page);\n\n  return { hits };\n}\n\nconst refs = {\n  searchForm: document.querySelector('form'),\n  imagesContainer: document.querySelector('.gallery-container'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n  loader: document.querySelector('.loader'),\n};\n\nconst ERROR_MESSAGES = {\n  noImages:\n    'Sorry, there are no images matching your search query. Please try again!',\n  enterQuery: 'Please enter a search query!',\n  endOfResults: \"We're sorry, but you've reached the end of search results.\",\n};\n\nrefs.searchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  refs.imagesContainer.innerHTML = '';\n  page = 1;\n\n  const form = event.currentTarget;\n  query = form.elements.input.value.trim();\n\n  if (!query) {\n    refs.imagesContainer.innerHTML = '';\n    showIziToast(ERROR_MESSAGES.enterQuery);\n    return;\n  }\n\n  try {\n    showLoader();\n    const data = await fetchImages(query);\n    showImagesGallery(data.hits);\n\n    if (data.hits.length > 0) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n      refs.loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else {\n      refs.loadMoreBtn.classList.add('is-hidden');\n    }\n  } catch (error) {\n    console.log(error);\n    // onFetchError();\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n\n  refs.loadMoreBtn.classList.add('is-hidden');\n  showLoader();\n\n  try {\n    const { hits } = await fetchImages(query, page);\n\n    showImagesGallery(hits);\n    refs.loadMoreBtn.classList.remove('is-hidden');\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n\n  if (page === maxPage) {\n    refs.loadMoreBtn.classList.add('is-hidden');\n    refs.loadMoreBtn.removeEventListener('click', handleLoadMore);\n    showIziToast(ERROR_MESSAGES.endOfResults);\n  }\n}\n\nfunction showImagesGallery(images) {\n  const createQueryImagesMarkup = ({\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  }) => `\n      <li class=\"gallery\">\n      <a href=\"${largeImageURL}\">\n        <img class=\"image-preview\" src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"image-description\">\n      <p>Likes ${likes}</p>\n      <p>Views ${views}</p>\n      <p>Comments ${comments}</p>\n      <p>Downloads ${downloads}</p>\n      </div>\n    </li>\n    `;\n\n  const galleryMarkup = images.map(createQueryImagesMarkup).join('');\n\n  refs.imagesContainer.insertAdjacentHTML('beforeend', galleryMarkup);\n  lightbox.refresh();\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction onFetchError() {\n  showIziToast(ERROR_MESSAGES.noImages);\n}\n\nfunction showIziToast(\n  message,\n  messageColor = 'white',\n  position = 'topRight',\n  color = 'red'\n) {\n  iziToast.show({\n    message,\n    messageColor,\n    position,\n    color,\n  });\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('is-hidden');\n}\n"],"names":["API_KEY","BASE_URL","query","page","maxPage","fetchImages","response","axios","hits","totalHits","refs","ERROR_MESSAGES","handleSearch","event","form","showIziToast","showLoader","data","showImagesGallery","handleLoadMore","error","hideLoader","images","createQueryImagesMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryMarkup","lightbox","SimpleLightbox","message","messageColor","position","color","iziToast"],"mappings":"owBAMA,MAAMA,EAAU,qCACVC,EAAW,0BAEjB,IAAIC,EAAQ,GACRC,EAAO,EACPC,EAAU,EAEd,eAAeC,EAAYH,EAAOC,EAAO,EAAG,CAC1C,MAAMG,EAAW,MAAMC,EAAM,IAAI,GAAGN,KAAa,CAC/C,OAAQ,CACN,IAAKD,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAC,CACD,CACL,CAAG,EAEK,CAAE,KAAAK,EAAM,UAAAC,GAAcH,EAAS,KACrC,OAAAF,EAAU,KAAK,KAAKK,EAAYN,CAAI,EAE7B,CAAE,KAAAK,CAAI,CACf,CAEA,MAAME,EAAO,CACX,WAAY,SAAS,cAAc,MAAM,EACzC,gBAAiB,SAAS,cAAc,oBAAoB,EAC5D,YAAa,SAAS,cAAc,2BAA2B,EAC/D,OAAQ,SAAS,cAAc,SAAS,CAC1C,EAEMC,EAAiB,CACrB,SACE,2EACF,WAAY,+BACZ,aAAc,4DAChB,EAEAD,EAAK,WAAW,iBAAiB,SAAUE,CAAY,EAEvD,eAAeA,EAAaC,EAAO,CACjCA,EAAM,eAAc,EAEpBH,EAAK,gBAAgB,UAAY,GACjCP,EAAO,EAEP,MAAMW,EAAOD,EAAM,cAGnB,GAFAX,EAAQY,EAAK,SAAS,MAAM,MAAM,KAAI,EAElC,CAACZ,EAAO,CACVQ,EAAK,gBAAgB,UAAY,GACjCK,EAAaJ,EAAe,UAAU,EACtC,MACD,CAED,GAAI,CACFK,IACA,MAAMC,EAAO,MAAMZ,EAAYH,CAAK,EACpCgB,EAAkBD,EAAK,IAAI,EAEvBA,EAAK,KAAK,OAAS,GACrBP,EAAK,YAAY,UAAU,OAAO,WAAW,EAC7CA,EAAK,YAAY,iBAAiB,QAASS,CAAc,GAEzDT,EAAK,YAAY,UAAU,IAAI,WAAW,CAE7C,OAAQU,EAAP,CACA,QAAQ,IAAIA,CAAK,CAErB,QAAY,CACRC,IACAP,EAAK,MAAK,CACX,CACH,CAEA,eAAeK,GAAiB,CAC9BhB,GAAQ,EAERO,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CM,IAEA,GAAI,CACF,KAAM,CAAE,KAAAR,CAAI,EAAK,MAAMH,EAAYH,EAAOC,CAAI,EAE9Ce,EAAkBV,CAAI,EACtBE,EAAK,YAAY,UAAU,OAAO,WAAW,CAC9C,OAAQU,EAAP,CACA,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRC,GACD,CAEGlB,IAASC,IACXM,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CA,EAAK,YAAY,oBAAoB,QAASS,CAAc,EAC5DJ,EAAaJ,EAAe,YAAY,EAE5C,CAEA,SAASO,EAAkBI,EAAQ,CACjC,MAAMC,EAA0B,CAAC,CAC/B,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACJ,IAAQ;AAAA;AAAA,iBAESL;AAAA,0CACyBD,WAAsBE;AAAA;AAAA;AAAA,iBAG/CC;AAAA,iBACAC;AAAA,oBACGC;AAAA,qBACCC;AAAA;AAAA;AAAA,MAKbC,EAAgBT,EAAO,IAAIC,CAAuB,EAAE,KAAK,EAAE,EAEjEb,EAAK,gBAAgB,mBAAmB,YAAaqB,CAAa,EAClEC,EAAS,QAAO,CAClB,CAEA,MAAMA,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAMD,SAASlB,EACPmB,EACAC,EAAe,QACfC,EAAW,WACXC,EAAQ,MACR,CACAC,EAAS,KAAK,CACZ,QAAAJ,EACA,aAAAC,EACA,SAAAC,EACA,MAAAC,CACJ,CAAG,CACH,CAEA,SAASrB,GAAa,CACpBN,EAAK,OAAO,UAAU,OAAO,WAAW,CAC1C,CAEA,SAASW,GAAa,CACpBX,EAAK,OAAO,UAAU,IAAI,WAAW,CACvC"}