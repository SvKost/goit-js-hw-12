{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst API_KEY = '41875605-6b47be3c8e074a549a6d5f149';\nconst BASE_URL = 'https://pixabay.com/api';\n\nlet query = '';\nlet page = 1;\nlet maxPage = 0;\nlet per_page = 40;\n\nasync function fetchImages(query, page = 1) {\n  const response = await axios.get(`${BASE_URL}/`, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page,\n      page,\n    },\n  });\n\n  const { hits, totalHits } = response.data;\n  maxPage = Math.ceil(totalHits / per_page);\n\n  return { hits, totalHits };\n}\n\nconst refs = {\n  searchForm: document.querySelector('form'),\n  imagesContainer: document.querySelector('.gallery-container'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n  loader: document.querySelector('.loader'),\n};\n\nrefs.searchForm.addEventListener('submit', handleSearch);\n\nconst cardHeight = refs.imagesContainer.getBoundingClientRect().height;\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  refs.imagesContainer.innerHTML = '';\n  page = 1;\n\n  const form = event.currentTarget;\n  query = form.elements.input.value.trim();\n\n  if (!query) {\n    refs.imagesContainer.innerHTML = '';\n    showIziToast(ERROR_MESSAGES.enterQuery);\n    hideLoader();\n    refs.loadMoreBtn.classList.add('is-hidden');\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await fetchImages(query);\n    showImagesGallery(hits);\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      showLoader();\n      refs.loadMoreBtn.classList.remove('is-hidden');\n      refs.loadMoreBtn.addEventListener('click', handleLoadMore);\n      window.scrollBy({ top: cardHeight, behavior: 'smooth' });\n    } else {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      if (hits.length === 0) {\n        showIziToast(ERROR_MESSAGES.noImages);\n      } else {\n        showIziToast(ERROR_MESSAGES.endOfResults);\n      }\n    }\n  } catch (error) {\n    showIziToast(ERROR_MESSAGES.noImages);\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n\n  refs.loadMoreBtn.classList.add('is-hidden');\n  showLoader();\n\n  try {\n    const { hits } = await fetchImages(query, page);\n\n    showImagesGallery(hits);\n\n    if (page < maxPage) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      showIziToast(ERROR_MESSAGES.endOfResults);\n      refs.loadMoreBtn.removeEventListener('click', handleLoadMore);\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction showImagesGallery(images) {\n  const createQueryImagesMarkup = ({\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  }) => `\n      <li class=\"gallery\">\n      <a href=\"${largeImageURL}\">\n        <img class=\"image-preview\" src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"image-description\">\n      <p>Likes ${likes}</p>\n      <p>Views ${views}</p>\n      <p>Comments ${comments}</p>\n      <p>Downloads ${downloads}</p>\n      </div>\n    </li>\n    `;\n\n  const galleryMarkup = images.map(createQueryImagesMarkup).join('');\n\n  refs.imagesContainer.insertAdjacentHTML('beforeend', galleryMarkup);\n  lightbox.refresh();\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst ERROR_MESSAGES = {\n  noImages:\n    'Sorry, there are no images matching your search query. Please try again!',\n  enterQuery: 'Please enter a search query!',\n  endOfResults: \"We're sorry, but you've reached the end of search results.\",\n};\n\nfunction showIziToast(\n  message,\n  messageColor = 'white',\n  position = 'topRight',\n  color = 'red'\n) {\n  iziToast.show({\n    message,\n    messageColor,\n    position,\n    color,\n  });\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('is-hidden');\n}\n"],"names":["API_KEY","BASE_URL","query","page","maxPage","per_page","fetchImages","response","axios","hits","totalHits","refs","handleSearch","cardHeight","event","form","showIziToast","ERROR_MESSAGES","hideLoader","showImagesGallery","showLoader","handleLoadMore","error","images","createQueryImagesMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryMarkup","lightbox","SimpleLightbox","message","messageColor","position","color","iziToast"],"mappings":"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"}