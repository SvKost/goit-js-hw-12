{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst API_KEY = '41875605-6b47be3c8e074a549a6d5f149';\nconst BASE_URL = 'https://pixabay.com/api';\n\nasync function fetchImages(query, page = 1) {\n  return axios\n    .get(`${BASE_URL}/`, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 3, // TODO: change quantity\n        page,\n      },\n    })\n    .then(({ data }) => data.hits);\n}\n\nconst refs = {\n  searchForm: document.querySelector('form'),\n  imagesContainer: document.querySelector('.gallery-container'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n  loader: document.querySelector('.loader'),\n};\n\nlet query = '';\nlet page = 1;\nlet maxPage = 0;\n\nconst ERROR_MESSAGES = {\n  noImages:\n    'Sorry, there are no images matching your search query. Please try again!',\n  enterQuery: 'Please enter a search query!',\n};\n\nrefs.searchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  refs.imagesContainer.innerHTML = '';\n  page = 1;\n\n  const form = event.currentTarget;\n  query = form.elements.input.value.trim();\n\n  if (!query) {\n    refs.imagesContainer.innerHTML = '';\n    showIziToast(ERROR_MESSAGES.enterQuery);\n    return;\n  }\n\n  try {\n    showLoader();\n    const data = await fetchImages(query);\n    showImagesGallery(data);\n\n    if (data.length > 0) {\n      refs.loadMoreBtn.classList.remove('is-hidden');\n      refs.loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else {\n      refs.loadMoreBtn.classList.add('is-hidden');\n    }\n  } catch {\n    onFetchError();\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n\n  refs.loadMoreBtn.classList.add('is-hidden');\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n\n    showImagesGallery(data);\n    refs.loadMoreBtn.classList.remove('is-hidden');\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n\n    if (page === data.totalHits) {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      refs.loadMoreBtn.removeEventListener('click', handleLoadMore);\n    }\n  }\n}\n\nfunction showImagesGallery(images) {\n  const createQueryImagesMarkup = ({\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  }) => `\n      <li class=\"gallery\">\n      <a href=\"${largeImageURL}\">\n        <img class=\"image-preview\" src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"image-description\">\n      <p>Likes ${likes}</p>\n      <p>Views ${views}</p>\n      <p>Comments ${comments}</p>\n      <p>Downloads ${downloads}</p>\n      </div>\n    </li>\n    `;\n\n  const galleryMarkup = images.map(createQueryImagesMarkup).join('');\n\n  refs.imagesContainer.insertAdjacentHTML('beforeend', galleryMarkup);\n  lightbox.refresh();\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction onFetchError() {\n  showIziToast(ERROR_MESSAGES.noImages);\n}\n\nfunction showIziToast(\n  message,\n  messageColor = 'white',\n  position = 'topRight',\n  color = 'red'\n) {\n  iziToast.show({\n    message,\n    messageColor,\n    position,\n    color,\n  });\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('is-hidden');\n}\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","axios","data","refs","ERROR_MESSAGES","handleSearch","event","form","showIziToast","showLoader","showImagesGallery","handleLoadMore","onFetchError","hideLoader","error","images","createQueryImagesMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryMarkup","lightbox","SimpleLightbox","message","messageColor","position","color","iziToast"],"mappings":"owBAMA,MAAMA,EAAU,qCACVC,EAAW,0BAEjB,eAAeC,EAAYC,EAAOC,EAAO,EAAG,CAC1C,OAAOC,EACJ,IAAI,GAAGJ,KAAa,CACnB,OAAQ,CACN,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACV,KAAAC,CACD,CACP,CAAK,EACA,KAAK,CAAC,CAAE,KAAAE,CAAM,IAAKA,EAAK,IAAI,CACjC,CAEA,MAAMC,EAAO,CACX,WAAY,SAAS,cAAc,MAAM,EACzC,gBAAiB,SAAS,cAAc,oBAAoB,EAC5D,YAAa,SAAS,cAAc,2BAA2B,EAC/D,OAAQ,SAAS,cAAc,SAAS,CAC1C,EAEA,IAAIJ,EAAQ,GACRC,EAAO,EAGX,MAAMI,EAAiB,CACrB,SACE,2EACF,WAAY,8BACd,EAEAD,EAAK,WAAW,iBAAiB,SAAUE,CAAY,EAEvD,eAAeA,EAAaC,EAAO,CACjCA,EAAM,eAAc,EAEpBH,EAAK,gBAAgB,UAAY,GACjCH,EAAO,EAEP,MAAMO,EAAOD,EAAM,cAGnB,GAFAP,EAAQQ,EAAK,SAAS,MAAM,MAAM,KAAI,EAElC,CAACR,EAAO,CACVI,EAAK,gBAAgB,UAAY,GACjCK,EAAaJ,EAAe,UAAU,EACtC,MACD,CAED,GAAI,CACFK,IACA,MAAMP,EAAO,MAAMJ,EAAYC,CAAK,EACpCW,EAAkBR,CAAI,EAElBA,EAAK,OAAS,GAChBC,EAAK,YAAY,UAAU,OAAO,WAAW,EAC7CA,EAAK,YAAY,iBAAiB,QAASQ,CAAc,GAEzDR,EAAK,YAAY,UAAU,IAAI,WAAW,CAEhD,MAAI,CACAS,GACJ,QAAY,CACRC,IACAN,EAAK,MAAK,CACX,CACH,CAEA,eAAeI,GAAiB,CAC9BX,GAAQ,EAERG,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CM,IAEA,GAAI,CACF,MAAMP,EAAO,MAAMJ,EAAYC,EAAOC,CAAI,EAE1CU,EAAkBR,CAAI,EACtBC,EAAK,YAAY,UAAU,OAAO,WAAW,CAC9C,OAAQW,EAAP,CACA,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRD,IAEIb,IAAS,KAAK,YAChBG,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CA,EAAK,YAAY,oBAAoB,QAASQ,CAAc,EAE/D,CACH,CAEA,SAASD,EAAkBK,EAAQ,CACjC,MAAMC,EAA0B,CAAC,CAC/B,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACJ,IAAQ;AAAA;AAAA,iBAESL;AAAA,0CACyBD,WAAsBE;AAAA;AAAA;AAAA,iBAG/CC;AAAA,iBACAC;AAAA,oBACGC;AAAA,qBACCC;AAAA;AAAA;AAAA,MAKbC,EAAgBT,EAAO,IAAIC,CAAuB,EAAE,KAAK,EAAE,EAEjEb,EAAK,gBAAgB,mBAAmB,YAAaqB,CAAa,EAClEC,EAAS,QAAO,CAClB,CAEA,MAAMA,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,SAASd,GAAe,CACtBJ,EAAaJ,EAAe,QAAQ,CACtC,CAEA,SAASI,EACPmB,EACAC,EAAe,QACfC,EAAW,WACXC,EAAQ,MACR,CACAC,EAAS,KAAK,CACZ,QAAAJ,EACA,aAAAC,EACA,SAAAC,EACA,MAAAC,CACJ,CAAG,CACH,CAEA,SAASrB,GAAa,CACpBN,EAAK,OAAO,UAAU,OAAO,WAAW,CAC1C,CAEA,SAASU,GAAa,CACpBV,EAAK,OAAO,UAAU,IAAI,WAAW,CACvC"}